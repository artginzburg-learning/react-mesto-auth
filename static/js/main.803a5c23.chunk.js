(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{20:function(e){e.exports=JSON.parse('{"a":"Art Ginzburg","b":{"type":"git","url":"git+https://github.com/artginzburg/react-mesto-auth.git"}}')},33:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(17),o=n.n(r),i=n(10),s=(n(33),n(14)),u=n.n(s),l=n(2),d=n(23),b=n(19),j=n(3),f=n(4),m="nomoreparties.co",h="/login",O="/register",p="/",_={title:"\u0412\u0445\u043e\u0434",action:"\u0412\u043e\u0439\u0442\u0438"},v={title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",action:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"},g={action:"\u0412\u044b\u0439\u0442\u0438"};function x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,c=Object(a.useRef)();Object(a.useEffect)((function(){c.current=t}),[t]),Object(a.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return c.current(e)};return n.addEventListener(e,t),function(){n.removeEventListener(e,t)}}}),[e,n])}function C(e,t){var n=Object(a.useState)((function(){try{var n=localStorage[e];return n?JSON.parse(n):t}catch(a){return console.log(a),t}})),c=Object(j.a)(n,2),r=c[0],o=c[1],i=Object(a.useCallback)((function(t){localStorage[e]=JSON.stringify(t),o(t)}),[e]);return x("storage",Object(a.useCallback)((function(n){n.key===e&&o(n.newValue?JSON.parse(n.newValue):t)}),[e,t])),[r,i]}var k=n(12),S=n(13),y=n(22),N=n(21),E=function(){function e(t){Object(k.a)(this,e),this._handleFetch=function(e){return e.ok?e.json():Promise.reject(e.status)},this._baseUrl=t.baseUrl,this._headers=t.headers,this._authFormat=""}return Object(S.a)(e,[{key:"_constructAuthorization",value:function(){this._headers=Object(l.a)(Object(l.a)({},this._headers),{},{authorization:this._authFormat+localStorage.token})}},{key:"_customFetch",value:function(e,t,n){var a,c={headers:null!==(a=this._headers)&&void 0!==a?a:{}};return t&&"GET"!==t&&(c.method=t,"DELETE"!==t&&(c.headers["Content-Type"]="application/json")),n&&(c.body=JSON.stringify(n)),fetch("".concat(this._baseUrl,"/").concat(e),c).then(this._handleFetch)}}]),e}(),w={url:new URL("https://mesto.".concat(m)),version:"v1",endpoints:{users:"users/me",cards:"cards"}},L=new(function(e){Object(y.a)(n,e);var t=Object(N.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).editProfile=function(t){var n=t.name,a=t.about;return e._customFetch(w.endpoints.users,"PATCH",{name:n,about:a})},e.addCard=function(t,n){return e._customFetch(w.endpoints.cards,"POST",{name:t,link:n})},e.deleteCard=function(t){return e._customFetch("".concat(w.endpoints.cards,"/").concat(t),"DELETE")},e.changeLikeCardStatus=function(t,n){return e._customFetch("".concat(w.endpoints.cards,"/likes/").concat(t),n?"PUT":"DELETE")},e.updateAvatar=function(t){var n=t.avatar;return e._customFetch("".concat(w.endpoints.users,"/avatar"),"PATCH",{avatar:n})},e}return Object(S.a)(n,[{key:"getUserInfo",value:function(){return this._customFetch(w.endpoints.users)}},{key:"getInitialCards",value:function(){return this._customFetch(w.endpoints.cards)}}]),n}(E))({baseUrl:"".concat(w.url.origin,"/").concat(w.version,"/").concat("cohort-24"),headers:{authorization:"70313b07-c3c0-40aa-a296-04d0e6bc7885"}}),T={url:new URL("https://auth.".concat(m)),endpoints:{signup:"signup",signin:"signin",user:"users/me"}},F=new(function(e){Object(y.a)(n,e);var t=Object(N.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e))._authFormat="Bearer ",a}return Object(S.a)(n,[{key:"register",value:function(e,t){return this._customFetch(T.endpoints.signup,"POST",{password:t,email:e})}},{key:"login",value:function(e,t){return this._customFetch(T.endpoints.signin,"POST",{password:t,email:e})}},{key:"getUserInfo",value:function(){return this._constructAuthorization(),this._customFetch(T.endpoints.user).then((function(e){return e.data}))}}]),n}(E))({baseUrl:T.url.origin}),I=n(1),U={name:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",about:"\u041f\u043e\u0442\u0435\u0440\u044f\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c"},A=c.a.createContext(),P=c.a.createContext();function R(e){var t=e.state,n=e.dispatch,a=e.children;return Object(I.jsx)(A.Provider,{value:t,children:Object(I.jsx)(P.Provider,{value:n,children:a})})}function D(){var e=c.a.useContext(A);if(void 0===e)throw new Error("useCurrentUser must be used within a CurrentUserProvider");return e}function B(){var e=c.a.useContext(P);if(void 0===e)throw new Error("useCurrentUserDispatcher must be used within a CurrentUserProvider");return e}function J(e,t){return JSON.stringify(e)===JSON.stringify(t)}function q(e,t,n,a){return z.apply(this,arguments)}function z(){return(z=Object(b.a)(u.a.mark((function e(t,n,a,c){var r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(l.a)(Object(l.a)({},n),a),t(r),e.prev=2,e.next=5,L[c](a);case 5:return o=e.sent,J(r,o)||t(o),e.abrupt("return",o);case 10:throw e.prev=10,e.t0=e.catch(2),t(n),console.log("Couldnt update user information on the server",e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}var V=function(e){return".".concat(e)},H="popup__close-button",M="form",G="form__input",Y="form__input_type_error",K="form__error_visible",Q="form__button",W={formSelector:V(M),inputSelector:V(G),submitButtonSelector:V(Q),inputErrorClass:Y,errorClass:K},X=n(8),Z=["onSubmit"],$=Object(a.memo)((function(e){var t=e.onSubmit,n=Object(X.a)(e,Z),c=Object(a.useCallback)((function(e){t&&(e.preventDefault(),t(e))}),[t]);return Object(I.jsx)("form",Object(l.a)(Object(l.a)({action:"#",onSubmit:c},n),{},{children:n.children}))})),ee=function(e){return e.filter(Boolean).join(" ")},te=function(e){return{className:ee(e)}},ne=["isFocused"],ae="text",ce=!0,re=2,oe=Object(a.forwardRef)((function(e,t){var n,c,r,o=e.isFocused,i=Object(X.a)(e,ne),s=null!==t&&void 0!==t?t:Object(a.createRef)(),u=null!==(n=i.type)&&void 0!==n?n:ae,d=null!==(c=i.required)&&void 0!==c?c:ce,b=u===ae?re:null,j={type:u,minLength:null!==(r=i.minLength)&&void 0!==r?r:b,required:d,ref:s};return Object(a.useEffect)((function(){o&&s&&s.current&&s.current.parentElement!==document.activeElement.parentElement&&setTimeout((function(){s&&s.current&&s.current.focus()}),50)}),[o,s]),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("input",Object(l.a)(Object(l.a)(Object(l.a)({},i),te([G,i.className])),j)),Object(I.jsx)("p",{className:"form__error",id:"".concat(i.id,"-error")})]})})),ie={autoCorrect:"off",spellCheck:!1,className:"".concat(G,"_theme_dark")},se="email",ue="password",le=Object(a.memo)((function(e){var t=Object(a.useState)(!1),n=Object(j.a)(t,2),c=n[0],r=n[1],o=c?e.buttonSavingTitle:e.buttonTitle,i=Object(j.a)(e.states.email,2),s=i[0],u=i[1],d=Object(j.a)(e.states.password,2),b=d[0],f=d[1];return Object(I.jsxs)("div",{className:"content auth",children:[Object(I.jsx)("h2",{className:"auth__title",children:e.title}),Object(I.jsxs)($,{onSubmit:function(t){r(!0),e.handleSubmit(t,s,b).finally((function(){r(!1)}))},onReset:function(){u(""),f("")},className:M,children:[Object(I.jsx)(oe,Object(l.a)(Object(l.a)({},ie),{},{autoFocus:!0,id:se,name:se,type:se,placeholder:"Email",autoComplete:se,value:s,onChange:function(e){u(e.target.value)}})),Object(I.jsx)(oe,Object(l.a)(Object(l.a)({},ie),{},{id:e.passwordAutocomplete,name:ue,type:ue,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",autoComplete:e.passwordAutocomplete,value:b,onChange:function(e){f(e.target.value)}})),Object(I.jsx)("button",{type:"submit",disabled:!s.length||!b.length,className:"auth__button ".concat(Q," ").concat(Q,"_theme_dark"),children:o})]}),e.children]})})),de={passwordAutocomplete:"current-password",title:_.title,buttonTitle:_.action,buttonSavingTitle:"".concat(_.title,"...")},be=Object(a.memo)((function(e){return Object(I.jsx)(le,Object(l.a)(Object(l.a)({},e),de))})),je={passwordAutocomplete:"new-password",title:v.title,buttonTitle:v.action,buttonSavingTitle:"".concat(v.title,"...")},fe=Object(a.memo)((function(e){return Object(I.jsx)(le,Object(l.a)(Object(l.a)(Object(l.a)({},e),je),{},{children:Object(I.jsxs)("div",{className:"auth__signin",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",Object(I.jsx)(i.b,{to:h,className:"auth__login-link",children:_.action})]})}))})),me=Object(a.memo)((function(e){var t,n,c={email:Object(a.useState)(null!==(n="email",t=localStorage[n]&&atob(JSON.parse(localStorage[n])))&&void 0!==t?t:""),password:Object(a.useState)("")};return e.loggedIn?Object(I.jsx)(f.a,{to:p}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(f.b,{path:h,children:Object(I.jsx)(be,{handleSubmit:e.handleLogin,states:c})}),Object(I.jsx)(f.b,{path:O,children:Object(I.jsx)(fe,{handleSubmit:e.handleRegister,states:c})})]})})),he=function(e){return Object(I.jsx)(f.b,{children:e.loggedIn?e.children:Object(I.jsx)(f.a,{to:h})})},Oe=n(20),pe=Oe.b.url.split(".");pe.pop();for(var _e=pe.join(".").split("+")[1],ve=n.p+"static/media/logo.6fa47d29.svg",ge=["loggedIn"],xe=Object(a.memo)((function(e){var t,n=e.loggedIn,a=Object(X.a)(e,ge),c=Object(f.h)(),r=h;switch(c.pathname){case h:t=v.title,r=O;break;case O:t=_.action;break;default:t=g.action}return Object(I.jsxs)("header",{className:"header",children:[Object(I.jsx)("a",{target:"_self",href:_e,className:"logo header__logo",children:Object(I.jsx)("img",{className:"logo__img",alt:"Mesto",src:ve})}),Object(I.jsxs)("div",{className:"header__container",children:[n&&a.credential&&Object(I.jsx)("p",{className:"header__credential",children:a.credential}),Object(I.jsx)(i.b,Object(l.a)(Object(l.a)({to:r,onClick:n?a.onSignOut:null},te(["header__action-button",n&&"header__action-button_dimmed"])),{},{children:t}))]})]})})),Ce=["card"],ke=Object(a.memo)((function(e){var t,n=e.card,a=Object(X.a)(e,Ce);n.likes=null!==(t=n.likes)&&void 0!==t?t:[];var c=D();n.isTemporarilyLocal&&(n.owner=c);var r=n.owner._id===c._id,o=n.likes.some((function(e){return e._id===c._id}));return Object(I.jsxs)("li",{className:"element",children:[Object(I.jsx)("img",{onClick:function(){a.onCardClick(n)},className:"element__image",alt:n.name,src:n.link}),r&&Object(I.jsx)("button",{onClick:function(){n.isTemporarilyLocal||a.onCardDelete(n)},type:"reset",className:"element__trash-button"}),Object(I.jsxs)("div",{className:"element__container",children:[Object(I.jsx)("h2",{className:"element__title",children:n.name}),Object(I.jsxs)("div",{className:"element__likes",children:[Object(I.jsx)("input",{checked:o,type:"checkbox",onChange:function(){n.isTemporarilyLocal||a.onCardLike(n)},className:"element__like-button"}),Object(I.jsx)("p",{className:"element__like-counter",children:n.likes.length})]})]})]})})),Se={isTemporarilyLocal:!0,name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."},ye=[],Ne=0;Ne<30;Ne++)ye.push(Se);var Ee=Object(a.memo)((function(e){var t=D(),n=Object(a.useMemo)((function(){return e.cards.length?e.cards:ye}),[e.cards]);return Object(I.jsxs)("main",{className:"content",children:[Object(I.jsxs)("section",{className:"profile",children:[Object(I.jsx)("button",{onClick:e.onEditAvatar,type:"button",className:"profile__avatar-container",children:Object(I.jsx)("img",{alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar",src:t.avatar})}),Object(I.jsxs)("div",{className:"profile__info",children:[Object(I.jsx)("h1",{className:"profile__name",children:t.name}),Object(I.jsx)("p",{className:"profile__description",children:t.about}),Object(I.jsx)("button",{onClick:e.onEditProfile,type:"button",className:"profile__edit-button"})]}),Object(I.jsx)("button",{onClick:e.onAddPlace,type:"button",className:"profile__add-button"})]}),Object(I.jsx)("section",{className:"elements",children:Object(I.jsx)("ul",{className:"elements__list",children:n.map((function(t){var n;return Object(I.jsx)(ke,{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete,card:t},null!==(n=t._id)&&void 0!==n?n:Math.random())}))})})]})})),we=_e.split("/");we.pop();var Le=we.join("/"),Te=(new Date).getFullYear(),Fe=Object(a.memo)((function(){return Object(I.jsx)("footer",{className:"footer",children:Object(I.jsxs)("a",{target:"_blank",rel:"noreferrer",href:Le,className:"footer__copyright",children:["\xa9 ",Te," ",Oe.a]})})})),Ie=function(){function e(t,n){var a=this;Object(k.a)(this,e),this._showInputError=function(e,t){var n=a._element.querySelector("#".concat(e.id,"-error"));e.classList.add(a._data.inputErrorClass),n.textContent=t,n.classList.add(a._data.errorClass)},this._hideInputError=function(e){var t=a._element.querySelector("#".concat(e.id,"-error"));e.classList.remove(a._data.inputErrorClass),t.classList.remove(a._data.errorClass),t.textContent=""},this._resetFormErrors=function(){a._inputList.forEach((function(e){return a._hideInputError(e)})),a._toggleButtonState(1)},this._checkInputValidity=function(e){return e.validity.valid?a._hideInputError(e):a._showInputError(e,e.validationMessage)},this._hasInvalidInput=function(e){return e.some((function(e){return!e.validity.valid}))},this._toggleButtonState=function(e){return a._buttonElement.disabled=e||a._hasInvalidInput(a._inputList)},this._validationHandler=function(e){a._checkInputValidity(e),a._toggleButtonState()},this._setListeners=function(){a._element.addEventListener("reset",a._resetFormErrors),a._inputList.forEach((function(e){e.value&&a._validationHandler(e),e.addEventListener("input",(function(){return a._validationHandler(e)}))}))},this._data=t,this._element=n,this._inputList=Array.from(this._element.querySelectorAll(this._data.inputSelector)),this._buttonElement=this._element.querySelector(this._data.submitButtonSelector)}return Object(S.a)(e,[{key:"enableValidation",value:function(){this._toggleButtonState(),this._setListeners()}}]),e}();var Ue=["isOpen"],Ae={className:"popup",classNameClosed:"",isOpened:!1};Ae.classNameOpened="".concat(Ae.className,"_opened");var Pe=document.getElementById("modal-root"),Re=Object(a.memo)((function(e){var t=e.isOpen,n=Object(X.a)(e,Ue),c=Object(a.useState)(Ae.classNameClosed),o=Object(j.a)(c,2),i=o[0],s=o[1],u=Object(a.useState)(Ae.isOpened),d=Object(j.a)(u,2),b=d[0],f=d[1];if(Object(a.useEffect)((function(){if(t||document.activeElement.blur(),t){f(!Ae.isOpened);var e=setTimeout((function(){s(Ae.classNameOpened)}),10);return function(){return clearTimeout(e)}}s(Ae.classNameClosed);var n=setTimeout((function(){f(Ae.isOpened)}),250);return function(){return clearTimeout(n)}}),[t]),!b)return null;var m=[Ae.className,n.className,i];return Object(r.createPortal)(Object(I.jsx)("section",Object(l.a)(Object(l.a)({onClick:n.onClick,style:{transitionDuration:"".concat(250,"ms")}},te(m)),{},{id:n.id,children:n.children})),Pe)})),De=function(e,t){var n=e.isOpen,a=e.isOpen!==t.isOpen;return!(n||a)},Be=function(e,t){function n(n){var a=Object(l.a)({isOpen:n.isOpen,onClick:n.onClose},t&&t(n));return Object(I.jsx)(Re,Object(l.a)(Object(l.a)({},a),{},{children:Object(I.jsx)(e,Object(l.a)({},n))}))}return Object(a.memo)(n,De)},Je=["onSubmit","children","onReset"],qe=Be((function(e){var t,n=e.onSubmit,c=e.children,r=e.onReset,o=Object(X.a)(e,Je),i=Object(a.useState)(!1),s=Object(j.a)(i,2),u=s[0],l=s[1],d=u?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":null!==(t=o.buttonTitle)&&void 0!==t?t:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",b=Object(a.useCallback)((function(e){l(!0),n&&n(e).then((function(t){return c&&(e.target.reset(),r&&r(e)),t})).catch((function(e){console.log(e)})).finally((function(){l(!1)}))}),[c,r,n]),f=o.name;return Object(a.useEffect)((function(){if(o.isOpen){var e=setTimeout((function(){var e;e=document.getElementById(f).querySelector(W.formSelector),new Ie(W,e).enableValidation()}),1);return function(){return clearTimeout(e)}}}),[f,o.isOpen]),Object(I.jsxs)("div",{className:"popup__container",children:[Object(I.jsx)("button",{type:"reset",className:H}),Object(I.jsx)("h2",{className:"popup__title",children:o.title}),Object(I.jsxs)($,{className:M,onSubmit:b,onReset:r,children:[c,Object(I.jsx)("button",{type:"submit",className:"popup__button ".concat(Q),children:d})]})]})}),(function(e){return{id:e.name}})),ze=Object(a.memo)((function(e){var t=Object(a.useState)(""),n=Object(j.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(""),i=Object(j.a)(o,2),s=i[0],u=i[1],d=D(),b=B();return Object(a.useEffect)((function(){e.isOpen||(r(d.name),u(d.about))}),[d,e.isOpen]),Object(I.jsxs)(qe,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){return q(b,d,{name:c,about:s},"editProfile").then((function(t){return e.onUpdateUser(),t}))},title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile-editor",children:[Object(I.jsx)(oe,{isFocused:e.isOpen,value:c,onChange:function(e){r(e.target.value)},autoComplete:"name",autoCapitalize:"words",name:"name",id:"profile-name",placeholder:"\u0418\u043c\u044f",maxLength:"40"}),Object(I.jsx)(oe,{value:s,onChange:function(e){u(e.target.value)},name:"about",id:"profile-about",placeholder:"\u041e \u0441\u0435\u0431\u0435",maxLength:"200"})]}))})),Ve=Object(a.memo)((function(e){var t=Object(a.useRef)(),n=D(),c=B();return Object(I.jsx)(qe,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){return q(c,n,{avatar:t.current.value},"updateAvatar").then((function(t){return e.onUpdateAvatar(),t}))},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar-editor",children:Object(I.jsx)(oe,{isFocused:e.isOpen,ref:t,type:"url",name:"avatar",id:"profile-avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"})}))})),He="",Me="",Ge=Object(a.memo)((function(e){var t=Object(a.useState)(He),n=Object(j.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(Me),i=Object(j.a)(o,2),s=i[0],u=i[1];return Object(I.jsxs)(qe,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){return e.onAddPlace(c,s)},onReset:function(){r(He),u(Me)},title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"element-editor",buttonTitle:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:[Object(I.jsx)(oe,{isFocused:e.isOpen,value:c,onChange:function(e){r(e.target.value)},name:"title",id:"element-title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",maxLength:"30"}),Object(I.jsx)(oe,{value:s,onChange:function(e){u(e.target.value)},type:"url",name:"link",id:"element-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"})]}))}));var Ye=Object(a.memo)((function(e){var t=e.onCardDelete,n=e.card,c=e.isOpen,r=Object(a.useCallback)((function(){return t(n)}),[n,t]);return function(e){var t=Object(a.useRef)();Object(a.useEffect)((function(){t.current=e}),[e]),x("keydown",Object(a.useCallback)((function(e){"Enter"===e.key&&t.current()}),[]))}(Object(a.useCallback)((function(){return c&&r()}),[r,c])),Object(I.jsx)(qe,Object(l.a)(Object(l.a)({},e),{},{onSubmit:r,title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete-confirmation",buttonTitle:"\u0414\u0430"}))})),Ke=[H,"".concat(H,"_parent-corners_straight")],Qe=Be((function(e){var t=e.card;return Object(I.jsxs)("figure",{className:"popup__figure",children:[Object(I.jsx)("button",Object(l.a)({type:"button"},te(Ke))),Object(I.jsx)("img",{className:"popup__image",alt:t.name,src:t.link}),Object(I.jsx)("figcaption",{className:"popup__caption",children:t.name})]})}),(function(){return{className:"popup_type_image",id:"image-viewer"}})),We=n.p+"static/media/check.5221857e.svg",Xe=n.p+"static/media/cross.173b3897.svg",Ze=Be((function(e){var t,n=e.isSuccess;return Object(I.jsxs)("div",{className:"popup__container",children:[Object(I.jsx)("button",{type:"button",className:H}),Object(I.jsxs)("div",{className:"info-tooltip",children:[Object(I.jsx)("div",{className:"info-tooltip__icon",style:(t=n?We:Xe,{backgroundImage:"url(".concat(t,")")})}),Object(I.jsx)("h3",{className:"info-tooltip__title",children:n?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]})]})}));var $e=function(){var e=Object(f.g)(),t=C("currentUser",U),n=Object(j.a)(t,2),r=n[0],o=n[1],i=C("loggedIn",!1),s=Object(j.a)(i,2),m=s[0],_=s[1],v=function(e,t){var n=C(e,t),c=Object(j.a)(n,2),r=c[0],o=c[1],i=Object(a.useCallback)((function(e){o(btoa(e))}),[o]),s=Object(a.useRef)(atob(r));return Object(a.useEffect)((function(){s.current=atob(r)})),[s.current,i]}("email",""),g=Object(j.a)(v,2),k=g[0],S=g[1],y=c.a.useState(!1),N=Object(j.a)(y,2),E=N[0],w=N[1],T=c.a.useState(!1),A=Object(j.a)(T,2),P=A[0],D=A[1],B=c.a.useState(!1),J=Object(j.a)(B,2),q=J[0],z=J[1],V=c.a.useState(!1),H=Object(j.a)(V,2),M=H[0],G=H[1],Y=c.a.useState(!1),K=Object(j.a)(Y,2),Q=K[0],W=K[1],X=c.a.useState(!1),Z=Object(j.a)(X,2),$=Z[0],ee=Z[1],te=c.a.useState(!1),ne=Object(j.a)(te,2),ae=ne[0],ce=ne[1],re=c.a.useState({}),oe=Object(j.a)(re,2),ie=oe[0],se=oe[1],ue=C("cards",[]),le=Object(j.a)(ue,2),de=le[0],be=le[1];function je(){return(je=Object(b.a)(u.a.mark((function e(t){var n,a,c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=de,a=t.likes.some((function(e){return e._id===r._id})),c=a?t.likes.filter((function(e){return e._id!==r._id})):[].concat(Object(d.a)(t.likes),[r]),o=Object(l.a)(Object(l.a)({},t),{},{likes:c}),be(de.map((function(e){return e._id===t._id?o:e}))),e.prev=5,e.next=8,L.changeLikeCardStatus(t._id,!a);case 8:return i=e.sent,be(de.map((function(e){return e._id===t._id?i:e}))),e.abrupt("return",i);case 13:e.prev=13,e.t0=e.catch(5),be(n),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}function fe(){z(!1),w(!1),D(!1),G(!1),W(!1),ee(!1)}c.a.useEffect((function(){L.getUserInfo().then(o).catch((function(e){return console.log("Couldnt get user info from the server",e)}))}),[o]),c.a.useEffect((function(){L.getInitialCards().then(be).catch((function(e){return console.log("Couldnt get initial cards from the server",e)}))}),[be]);var Oe=c.a.useCallback((function(e){var t=de;return be(de.filter((function(t){return t._id!==e._id}))),fe(),L.deleteCard(e._id).catch((function(e){be(t),console.log("Couldnt delete card on the server",e)}))}),[de,be]),pe=c.a.useCallback((function(e){e.target===e.currentTarget&&fe()}),[]),_e=fe,ve=fe;!function(e){var t=Object(a.useRef)();Object(a.useEffect)((function(){t.current=e}),[e]),x("keydown",Object(a.useCallback)((function(e){"Escape"===e.key&&t.current()}),[]))}(fe);var ge=c.a.useCallback((function(e){S(e),_(!0)}),[S,_]),Ce=c.a.useCallback((function(){localStorage.token?(F.token=localStorage.token,F.getUserInfo().then((function(t){t&&(ge(t.email),e.replace(p))})).catch((function(e){_(!1),console.log(e)}))):_(!1)}),[ge,e,_]);return c.a.useEffect((function(){Ce()}),[Ce]),Object(I.jsxs)(R,{state:r,dispatch:o,children:[Object(I.jsx)(xe,{credential:k,onSignOut:function(){delete localStorage.token,_(!1),e.replace(h),window.scrollTo(0,0)},loggedIn:m}),Object(I.jsxs)(f.d,{children:[Object(I.jsxs)(f.b,{path:[O,h],children:[Object(I.jsx)(me,{loggedIn:m,handleLogin:function(t,n,a){if(n&&a)return F.login(n,a).then((function(a){a.token&&(t.target.reset(),localStorage.token=a.token,ge(n),e.push(p))})).catch((function(e){ee(!0),console.log(e)}))},handleRegister:function(t,n,a){return F.register(n,a).then((function(){e.replace(h),ce(!0)})).catch((function(e){ce(!1),console.log(e)})).finally((function(){ee(!0)}))}}),Object(I.jsx)(Ze,{isOpen:$,isSuccess:ae,onClose:pe})]}),Object(I.jsxs)(he,{path:p,loggedIn:m,children:[Object(I.jsx)(Ee,{onEditProfile:function(){w(!0)},onAddPlace:function(){D(!0)},onEditAvatar:function(){z(!0)},cards:de,onCardClick:function(e){se(e),W(!0)},onCardLike:function(e){return je.apply(this,arguments)},onCardDelete:function(e){se(e),G(!0)}}),Object(I.jsx)(ze,{onUpdateUser:_e,isOpen:E,onClose:pe}),Object(I.jsx)(Ge,{onAddPlace:function(e,t){var n=de;return be([{isTemporarilyLocal:!0,name:e,link:t}].concat(Object(d.a)(de))),fe(),L.addCard(e,t).then((function(e){return be([e].concat(Object(d.a)(de)))})).catch((function(e){throw be(n),e}))},isOpen:P,onClose:pe}),Object(I.jsx)(Ve,{onUpdateAvatar:ve,isOpen:q,onClose:pe}),Object(I.jsx)(Ye,{card:ie,onCardDelete:Oe,isOpen:M,onClose:pe}),Object(I.jsx)(Qe,{card:ie,isOpen:Q,onClose:pe})]})]}),Object(I.jsx)(Fe,{})]})},et=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,45)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(I.jsx)(c.a.StrictMode,{children:Object(I.jsx)(i.a,{basename:"/react-mesto-auth",children:Object(I.jsx)($e,{})})}),document.getElementById("root")),et()}},[[44,1,2]]]);
//# sourceMappingURL=main.803a5c23.chunk.js.map