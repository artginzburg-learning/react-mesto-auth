(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{17:function(e){e.exports=JSON.parse('{"b":"https://artginzburg.github.io/react-mesto-auth/","a":"Art Ginzburg","c":{"type":"git","url":"git+https://github.com/artginzburg/react-mesto-auth.git"}}')},33:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(27),o=n.n(c),i=n(9),s=(n(33),n(14)),u=n.n(s),l=n(2),d=n(22),b=n(19),m=n(3),j=n(4),h="nomoreparties.co",f="/login",p="/register",O="/",_={login:"/react-mesto-auth"+f,register:"/react-mesto-auth"+p,main:"/react-mesto-auth"+O},v={login:"*".concat(f),register:"*".concat(p),main:"*".concat(O)},g={title:"\u0412\u0445\u043e\u0434",action:"\u0412\u043e\u0439\u0442\u0438"},x={title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",action:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"},C={action:"\u0412\u044b\u0439\u0442\u0438"};function k(e,t){var n=Object(a.useState)(localStorage[e]?JSON.parse(localStorage[e]):t),r=Object(m.a)(n,2),c=r[0],o=r[1],i=Object(a.useCallback)((function(n){n.key===e&&o(n.newValue?JSON.parse(n.newValue):t)}),[e,t]),s=Object(a.useCallback)((function(t){localStorage[e]=JSON.stringify(t),o(t)}),[e]);return Object(a.useEffect)((function(){var e,t=["storage",i];return(e=window).addEventListener.apply(e,t),function(){var e;(e=window).removeEventListener.apply(e,t)}}),[i]),[c,s]}var S=n(11),y=n(12),N=n(21),E=n(20),w=function(){function e(t){Object(S.a)(this,e),this._handleFetch=function(e){return e.ok?e.json():Promise.reject(e.status)},this._baseUrl=t.baseUrl,this._headers=t.headers,this._authFormat=""}return Object(y.a)(e,[{key:"_constructAuthorization",value:function(){this._headers=Object(l.a)(Object(l.a)({},this._headers),{},{authorization:this._authFormat+localStorage.token})}},{key:"_customFetch",value:function(e,t,n){var a,r={headers:null!==(a=this._headers)&&void 0!==a?a:{}};return t&&"GET"!==t&&(r.method=t,"DELETE"!==t&&(r.headers["Content-Type"]="application/json")),n&&(r.body=JSON.stringify(n)),fetch("".concat(this._baseUrl,"/").concat(e),r).then(this._handleFetch)}}]),e}(),L={url:new URL("https://mesto.".concat(h)),version:"v1",endpoints:{users:"users/me",cards:"cards"}},T=new(function(e){Object(N.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(S.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).editProfile=function(t){var n=t.name,a=t.about;return e._customFetch(L.endpoints.users,"PATCH",{name:n,about:a})},e.addCard=function(t,n){return e._customFetch(L.endpoints.cards,"POST",{name:t,link:n})},e.deleteCard=function(t){return e._customFetch("".concat(L.endpoints.cards,"/").concat(t),"DELETE")},e.changeLikeCardStatus=function(t,n){return e._customFetch("".concat(L.endpoints.cards,"/likes/").concat(t),n?"PUT":"DELETE")},e.updateAvatar=function(t){var n=t.avatar;return e._customFetch("".concat(L.endpoints.users,"/avatar"),"PATCH",{avatar:n})},e}return Object(y.a)(n,[{key:"getUserInfo",value:function(){return this._customFetch(L.endpoints.users)}},{key:"getInitialCards",value:function(){return this._customFetch(L.endpoints.cards)}}]),n}(w))({baseUrl:"".concat(L.url.origin,"/").concat(L.version,"/").concat("cohort-24"),headers:{authorization:"70313b07-c3c0-40aa-a296-04d0e6bc7885"}}),F={url:new URL("https://auth.".concat(h)),endpoints:{signup:"signup",signin:"signin",user:"users/me"}},U=new(function(e){Object(N.a)(n,e);var t=Object(E.a)(n);function n(e){var a;return Object(S.a)(this,n),(a=t.call(this,e))._authFormat="Bearer ",a}return Object(y.a)(n,[{key:"register",value:function(e,t){return this._customFetch(F.endpoints.signup,"POST",{password:t,email:e})}},{key:"login",value:function(e,t){return this._customFetch(F.endpoints.signin,"POST",{password:t,email:e})}},{key:"getUserInfo",value:function(){return this._constructAuthorization(),this._customFetch(F.endpoints.user).then((function(e){return e.data}))}}]),n}(w))({baseUrl:F.url.origin}),A=n(1),I={name:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",about:"\u041f\u043e\u0442\u0435\u0440\u044f\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c"},P=r.a.createContext(),D=r.a.createContext();function B(e){var t=e.children,n=k("currentUser",I),a=Object(m.a)(n,2),c=a[0],o=a[1];return r.a.useEffect((function(){T.getUserInfo().then(o).catch((function(e){return console.log("Couldnt get user info from the server",e)}))}),[o]),Object(A.jsx)(P.Provider,{value:c,children:Object(A.jsx)(D.Provider,{value:o,children:t})})}function J(){var e=r.a.useContext(P);if(void 0===e)throw new Error("useCurrentUser must be used within a CurrentUserProvider");return e}function z(){var e=r.a.useContext(D);if(void 0===e)throw new Error("useCurrentUserDispatcher must be used within a CurrentUserProvider");return e}function R(e,t){return JSON.stringify(e)===JSON.stringify(t)}function q(e,t,n,a){return V.apply(this,arguments)}function V(){return(V=Object(b.a)(u.a.mark((function e(t,n,a,r){var c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(l.a)(Object(l.a)({},n),a),t(c),e.prev=2,e.next=5,T[r](a);case 5:o=e.sent,R(c,o)||t(o),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(2),t(n),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}for(var H=n(13),M=["onSubmit"],G=Object(a.memo)((function(e){var t=e.onSubmit,n=Object(H.a)(e,M),r=Object(a.useCallback)((function(e){t&&(e.preventDefault(),t(e))}),[t]);return Object(A.jsx)("form",Object(l.a)(Object(l.a)({action:"#",onSubmit:r},n),{},{children:e.children}))})),K=["isFocused"],Q="text",W=!0,X=2,Y=Object(a.forwardRef)((function(e,t){var n,r,c,o=null!==t&&void 0!==t?t:Object(a.createRef)(),i=null!==(n=e.type)&&void 0!==n?n:Q,s=null!==(r=e.required)&&void 0!==r?r:W,u=i===Q?X:null,d={type:i,minLength:null!==(c=e.minLength)&&void 0!==c?c:u,required:s,ref:o},b=e.isFocused,m=Object(H.a)(e,K);return Object(a.useEffect)((function(){b&&o&&o.current&&o.current.parentElement!==document.activeElement.parentElement&&setTimeout((function(){o&&o.current&&o.current.focus()}),50)}),[b,o]),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("input",Object(l.a)(Object(l.a)({},m),{},{className:"form__input".concat(m.className?" ".concat(m.className):"")},d)),Object(A.jsx)("p",{className:"form__error",id:"".concat(e.id,"-error")})]})})),Z={autoCorrect:"off",spellCheck:!1,className:"form__input_theme_dark"},$=Object(a.memo)((function(e){var t=Object(m.a)(e.states.email,2),n=t[0],a=t[1],r=Object(m.a)(e.states.password,2),c=r[0],o=r[1];return Object(A.jsxs)("div",{className:"auth",children:[Object(A.jsx)("h2",{className:"auth__title",children:e.title}),Object(A.jsxs)(G,{onSubmit:e.onSubmit,className:"form",children:[Object(A.jsx)(Y,Object(l.a)(Object(l.a)({},Z),{},{autoFocus:!0,id:"email",name:"email",type:"email",placeholder:"Email",autoComplete:"email",value:n,onChange:function(e){a(e.target.value)}})),Object(A.jsx)(Y,Object(l.a)(Object(l.a)({},Z),{},{id:e.passwordAutocomplete,name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",autoComplete:e.passwordAutocomplete,value:c,onChange:function(e){o(e.target.value)}})),Object(A.jsx)("button",{type:"submit",className:"auth__button form__button form__button_theme_dark",children:e.buttonTitle})]}),e.children]})})),ee=Object(j.g)($),te={passwordAutocomplete:"current-password",title:g.title,buttonTitle:g.action},ne=Object(a.memo)((function(e){var t=Object(m.a)(e.states.email,2),n=t[0],a=t[1],r=Object(m.a)(e.states.password,2),c=r[0],o=r[1];return Object(A.jsx)(ee,Object(l.a)(Object(l.a)({onSubmit:function(){n&&c&&U.login(n,c).then((function(t){t.token&&(a(""),o(""),localStorage.token=t.token,e.handleLogin(n),e.history.push(_.main))})).catch((function(e){return console.log(e)}))}},e),te))})),ae=Object(j.g)(ne),re={passwordAutocomplete:"new-password",title:x.title,buttonTitle:x.action},ce=Object(a.memo)((function(e){var t=Object(m.a)(e.states.email,1)[0],n=Object(m.a)(e.states.password,1)[0];return Object(A.jsx)(ee,Object(l.a)(Object(l.a)(Object(l.a)({onSubmit:function(){U.register(t,n).then((function(t){400!==t.statusCode&&e.history.push(_.login)}))}},e),re),{},{children:Object(A.jsxs)("div",{className:"auth__signin",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",Object(A.jsx)(i.b,{to:_.login,className:"auth__login-link",children:g.action})]})}))})),oe=Object(j.g)(ce),ie=Object(a.memo)((function(e){var t={email:Object(a.useState)(""),password:Object(a.useState)("")};return e.location.pathname===_.login?Object(A.jsx)(ae,{handleLogin:e.handleLogin,states:t}):Object(A.jsx)(oe,{states:t})})),se=Object(j.g)(ie),ue=function(e){return Object(A.jsx)(j.b,{children:e.loggedIn?e.children:Object(A.jsx)(j.a,{to:_.login})})},le=n(17),de=n.p+"static/media/logo.6fa47d29.svg",be=Object(a.memo)((function(e){var t,n=_.login,a=!1;switch(e.location.pathname){case _.login:t=x.title,n=_.register;break;case _.register:t=g.action;break;default:t=C.action,a=!0}return Object(A.jsxs)("header",{className:"header",children:[Object(A.jsx)("a",{target:"_self",href:le.b,className:"logo header__logo",children:Object(A.jsx)("img",{className:"logo__img",alt:"Mesto",src:de})}),Object(A.jsxs)("div",{className:"header__container",children:[a&&e.credential?Object(A.jsx)("p",{className:"header__credential",children:e.credential}):null,Object(A.jsx)(i.b,{to:n,onClick:a?function(){delete localStorage.token,e.history.push(_.login)}:null,className:"header__action-button".concat(a?" header__action-button_dimmed":""),children:t})]})]})})),me=Object(j.g)(be),je="element__trash-button",he="element__like-button",fe=Object(a.memo)((function(e){var t,n=e.card;n.likes=null!==(t=n.likes)&&void 0!==t?t:[];var a=J();n.isTemporarilyLocal&&(n.owner=a);var r=[je];if(n.owner._id===a._id){var c="".concat(je,"_visible");r.push(c)}var o=r.join(" "),i=[he];if(n.likes.some((function(e){return e._id===a._id}))){var s="".concat(he,"_active");i.push(s)}var u=i.join(" ");return Object(A.jsxs)("li",{className:"element",children:[Object(A.jsx)("img",{onClick:function(){e.onCardClick(n)},className:"element__image",alt:n.name,src:n.link}),Object(A.jsx)("button",{onClick:function(){n.isTemporarilyLocal||e.onCardDelete(n)},type:"reset",className:o}),Object(A.jsxs)("div",{className:"element__container",children:[Object(A.jsx)("h2",{className:"element__title",children:n.name}),Object(A.jsxs)("div",{className:"element__likes",children:[Object(A.jsx)("button",{onClick:function(){n.isTemporarilyLocal||e.onCardLike(n)},type:"button",className:u}),Object(A.jsx)("p",{className:"element__like-counter",children:n.likes.length})]})]})]})})),pe={isTemporarilyLocal:!0,name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."},Oe=[],_e=0;_e<30;_e++)Oe.push(pe);var ve=Object(a.memo)((function(e){var t=J(),n=Object(a.useMemo)((function(){return e.cards.length?e.cards:Oe}),[e.cards]);return Object(A.jsxs)("main",{className:"content",children:[Object(A.jsxs)("section",{className:"profile",children:[Object(A.jsx)("button",{onClick:e.onEditAvatar,type:"button",className:"profile__avatar-container",children:Object(A.jsx)("img",{alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar",src:t.avatar})}),Object(A.jsxs)("div",{className:"profile__info",children:[Object(A.jsx)("h1",{className:"profile__name",children:t.name}),Object(A.jsx)("p",{className:"profile__description",children:t.about}),Object(A.jsx)("button",{onClick:e.onEditProfile,type:"button",className:"profile__edit-button"})]}),Object(A.jsx)("button",{onClick:e.onAddPlace,type:"button",className:"profile__add-button"})]}),Object(A.jsx)("section",{className:"elements",children:Object(A.jsx)("ul",{className:"elements__list",children:n.map((function(t){var n;return Object(A.jsx)(fe,{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete,card:t},null!==(n=t._id)&&void 0!==n?n:Math.random())}))})})]})})),ge=le.c.url.split("/");ge.pop();var xe=ge.join("/").split("+")[1],Ce=Object(a.memo)((function(){return Object(A.jsx)("footer",{className:"footer",children:Object(A.jsxs)("a",{target:"_blank",rel:"noreferrer",href:xe,className:"footer__copyright",children:["\xa9 2021 ",le.a]})})})),ke="popup__close-button",Se={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},ye=function(){function e(t,n){var a=this;Object(S.a)(this,e),this._showInputError=function(e,t){var n=a._element.querySelector("#".concat(e.id,"-error"));e.classList.add(a._data.inputErrorClass),n.textContent=t,n.classList.add(a._data.errorClass)},this._hideInputError=function(e){var t=a._element.querySelector("#".concat(e.id,"-error"));e.classList.remove(a._data.inputErrorClass),t.classList.remove(a._data.errorClass),t.textContent=""},this._resetFormErrors=function(){a._inputList.forEach((function(e){return a._hideInputError(e)})),a._toggleButtonState(1)},this._checkInputValidity=function(e){return e.validity.valid?a._hideInputError(e):a._showInputError(e,e.validationMessage)},this._hasInvalidInput=function(e){return e.some((function(e){return!e.validity.valid}))},this._toggleButtonState=function(e){return a._buttonElement.disabled=e||a._hasInvalidInput(a._inputList)},this._validationHandler=function(e){a._checkInputValidity(e),a._toggleButtonState()},this._setListeners=function(){a._element.addEventListener("reset",a._resetFormErrors),a._inputList.forEach((function(e){e.value&&a._validationHandler(e),e.addEventListener("input",(function(){return a._validationHandler(e)}))}))},this._data=t,this._element=n,this._inputList=Array.from(this._element.querySelectorAll(this._data.inputSelector)),this._buttonElement=this._element.querySelector(this._data.submitButtonSelector)}return Object(y.a)(e,[{key:"enableValidation",value:function(){this._toggleButtonState(),this._setListeners()}}]),e}();var Ne={className:"popup",classNameClosed:"",isOpened:!1};Ne.classNameOpened="".concat(Ne.className,"_opened");var Ee=Object(a.memo)((function(e){var t=Object(a.useState)(Ne.classNameClosed),n=Object(m.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(Ne.isOpened),i=Object(m.a)(o,2),s=i[0],u=i[1];if(Object(a.useEffect)((function(){if(e.isOpen||document.activeElement.blur(),e.isOpen){u(!Ne.isOpened);var t=setTimeout((function(){c(Ne.classNameOpened)}),10);return function(){return clearTimeout(t)}}c(Ne.classNameClosed);var n=setTimeout((function(){u(Ne.isOpened)}),300);return function(){return clearTimeout(n)}}),[e.isOpen]),!s)return null;var l=[Ne.className,e.className,r].filter((function(e){return null!=e&&""!==e})).join(" ");return Object(A.jsx)("section",{onClick:e.onClick,className:l,id:e.id,children:e.children})})),we=["onSubmit","children"],Le=Object(a.memo)((function(e){var t,n=e,r=n.onSubmit,c=n.children,o=Object(H.a)(n,we),i=null!==(t=(e=o).buttonTitle)&&void 0!==t?t:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",s=Object(a.useCallback)((function(e){r&&r(e),c&&e.target.reset()}),[c,r]),u=e.name;return Object(a.useEffect)((function(){if(e.isOpen){var t=setTimeout((function(){var e;e=document.getElementById(u).querySelector(Se.formSelector),new ye(Se,e).enableValidation()}),1);return function(){return clearTimeout(t)}}}),[u,e.isOpen]),Object(A.jsx)(Ee,{isOpen:e.isOpen,onClick:e.onClose,id:u,children:Object(A.jsxs)("div",{className:"popup__container",children:[Object(A.jsx)("button",{type:"reset",className:ke}),Object(A.jsx)("h2",{className:"popup__title",children:e.title}),Object(A.jsxs)(G,{className:"form",onSubmit:s,onReset:e.onReset,children:[c,Object(A.jsx)("button",{type:"submit",className:"popup__button form__button",children:i})]})]})})})),Te=Object(a.memo)((function(e){var t=Object(a.useState)(""),n=Object(m.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(""),i=Object(m.a)(o,2),s=i[0],u=i[1],d=J(),b=z();return Object(a.useEffect)((function(){c(d.name),u(d.about)}),[d]),Object(A.jsxs)(Le,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){q(b,d,{name:r,about:s},"editProfile"),e.onUpdateUser()},title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile-editor",children:[Object(A.jsx)(Y,{isFocused:e.isOpen,value:r,onChange:function(e){c(e.target.value)},autoComplete:"name",autoCapitalize:"words",name:"name",id:"profile-name",placeholder:"\u0418\u043c\u044f",maxLength:"40"}),Object(A.jsx)(Y,{value:s,onChange:function(e){u(e.target.value)},name:"about",id:"profile-about",placeholder:"\u041e \u0441\u0435\u0431\u0435",maxLength:"200"})]}))})),Fe=Object(a.memo)((function(e){var t=Object(a.useRef)(),n=J(),r=z();return Object(A.jsx)(Le,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){q(r,n,{avatar:t.current.value},"updateAvatar"),e.onUpdateAvatar()},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar-editor",children:Object(A.jsx)(Y,{isFocused:e.isOpen,ref:t,type:"url",name:"avatar",id:"profile-avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"})}))})),Ue="",Ae="",Ie=Object(a.memo)((function(e){var t=Object(a.useState)(Ue),n=Object(m.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(Ae),i=Object(m.a)(o,2),s=i[0],u=i[1];return Object(A.jsxs)(Le,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){e.onAddPlace(r,s)},onReset:function(){c(Ue),u(Ae)},title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"element-editor",buttonTitle:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:[Object(A.jsx)(Y,{isFocused:e.isOpen,value:r,onChange:function(e){c(e.target.value)},name:"title",id:"element-title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",maxLength:"30"}),Object(A.jsx)(Y,{value:s,onChange:function(e){u(e.target.value)},type:"url",name:"link",id:"element-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"})]}))})),Pe=Object(a.memo)((function(e){return Object(A.jsx)(Le,Object(l.a)(Object(l.a)({},e),{},{onSubmit:function(){e.onCardDelete(e.card)},title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete-confirmation",buttonTitle:"\u0414\u0430"}))})),De=[ke,"".concat(ke,"_parent-corners_straight")].join(" "),Be=Object(a.memo)((function(e){var t=e.card;return Object(A.jsx)(Ee,{isOpen:e.isOpen,onClick:e.onClose,className:"popup_type_image",id:"image-viewer",children:Object(A.jsxs)("figure",{className:"popup__figure",children:[Object(A.jsx)("button",{type:"button",className:De}),Object(A.jsx)("img",{className:"popup__image",alt:t.name,src:t.link}),Object(A.jsx)("figcaption",{className:"popup__caption",children:t.name})]})})}));var Je=Object(j.g)((function(e){var t=J(),n=r.a.useState(!!localStorage.token),a=Object(m.a)(n,2),c=a[0],o=a[1],i=r.a.useState(""),s=Object(m.a)(i,2),h=s[0],f=s[1],p=r.a.useState(!1),O=Object(m.a)(p,2),g=O[0],x=O[1],C=r.a.useState(!1),S=Object(m.a)(C,2),y=S[0],N=S[1],E=r.a.useState(!1),w=Object(m.a)(E,2),L=w[0],F=w[1],I=r.a.useState(!1),P=Object(m.a)(I,2),D=P[0],B=P[1],z=r.a.useState(!1),R=Object(m.a)(z,2),q=R[0],V=R[1],H=r.a.useState({}),M=Object(m.a)(H,2),G=M[0],K=M[1],Q=k("cards",[]),W=Object(m.a)(Q,2),X=W[0],Y=W[1];function Z(){return(Z=Object(b.a)(u.a.mark((function e(n){var a,r,c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=X,r=n.likes.some((function(e){return e._id===t._id})),c=r?n.likes.filter((function(e){return e._id!==t._id})):[].concat(Object(d.a)(n.likes),[t]),o=Object(l.a)(Object(l.a)({},n),{},{likes:c}),Y(X.map((function(e){return e._id===n._id?o:e}))),e.prev=5,e.next=8,T.changeLikeCardStatus(n._id,!r);case 8:i=e.sent,Y(X.map((function(e){return e._id===n._id?i:e}))),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),Y(a),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,12]])})))).apply(this,arguments)}function $(){F(!1),x(!1),N(!1),B(!1),V(!1)}r.a.useEffect((function(){T.getInitialCards().then(Y).catch((function(e){return console.log("Couldnt get initial cards from the server",e)}))}),[Y]);var ee=r.a.useCallback((function(e){var t=X;Y(X.filter((function(t){return t._id!==e._id}))),T.deleteCard(e._id).catch((function(e){throw Y(t),e})),$()}),[X,Y]),te=r.a.useCallback((function(e){e.target===e.currentTarget&&$()}),[]),ne=$,ae=$,re=r.a.useCallback((function(e){"Escape"===e.key&&$()}),[]);r.a.useEffect((function(){var e,t=["keydown",re,!1];return(e=document).addEventListener.apply(e,t),function(){var e;return(e=document).removeEventListener.apply(e,t)}}),[re]);var ce=r.a.useCallback((function(e){f(e),o(!0)}),[o]),oe=r.a.useCallback((function(){localStorage.token&&(U.token=localStorage.token,U.getUserInfo().then((function(t){t&&(ce(t.email),e.history.push(_.main))})).catch((function(e){o(!1),console.log(e)})))}),[ce,e.history]);return r.a.useEffect((function(){oe()}),[oe]),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(me,{credential:h}),Object(A.jsxs)(j.d,{children:[Object(A.jsx)(j.b,{path:[v.register,v.login],children:Object(A.jsx)(se,{handleLogin:ce})}),Object(A.jsxs)(ue,{path:v.main,loggedIn:c,children:[Object(A.jsx)(ve,{onEditProfile:function(){x(!0)},onAddPlace:function(){N(!0)},onEditAvatar:function(){F(!0)},cards:X,onCardClick:function(e){K(e),V(!0)},onCardLike:function(e){return Z.apply(this,arguments)},onCardDelete:function(e){K(e),B(!0)}}),Object(A.jsx)(Te,{onUpdateUser:ne,isOpen:g,onClose:te}),Object(A.jsx)(Ie,{onAddPlace:function(e,t){var n=X;Y([{isTemporarilyLocal:!0,name:e,link:t}].concat(Object(d.a)(X))),T.addCard(e,t).then((function(e){return Y([e].concat(Object(d.a)(X)))})).catch((function(){return Y(n)})),$()},isOpen:y,onClose:te}),Object(A.jsx)(Fe,{onUpdateAvatar:ae,isOpen:L,onClose:te}),Object(A.jsx)(Pe,{card:G,onCardDelete:ee,isOpen:D,onClose:te}),Object(A.jsx)(Be,{card:G,isOpen:q,onClose:te})]})]}),Object(A.jsx)(Ce,{})]})})),ze=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,45)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};o.a.render(Object(A.jsx)(r.a.StrictMode,{children:Object(A.jsx)(i.a,{children:Object(A.jsx)(B,{children:Object(A.jsx)(Je,{})})})}),document.getElementById("root")),ze()}},[[44,1,2]]]);
//# sourceMappingURL=main.e0e26982.chunk.js.map